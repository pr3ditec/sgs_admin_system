import{d as O,u as P,r as o,p as V,o as J,i as _,w as n,f as N,a as i,t as x,h as k,T as S,l as j,H as $,b as l,k as X}from"./index-DlXReHYW.js";import{b as Q,a as h,l as W,v as d}from"./Validator-BLuEWHG9.js";import{R as p}from"./Response-Degt4AJ1.js";import{_ as Y}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-CMILcdRT.js";import{_ as B}from"./FormLayout.vue_vue_type_script_setup_true_lang-2C9QneGZ.js";import{_ as F}from"./SGSButton.vue_vue_type_script_setup_true_lang-BR4KmKdI.js";import{_ as a}from"./SGSInput.vue_vue_type_script_setup_true_lang-B8Bwi16F.js";import{S as s}from"./SGSDivider-Bofd5NDC.js";import{S as G}from"./SGSAddress-0615-Nvj.js";const Z={class:"flex flex-col items-center"},ee={class:"flex flex-row gap-2 mx-auto"},fe=O({__name:"CreateClientView",setup(le){const q=P().request,c=o(0),m=o({isLoading:!1,isDisabled:!1}),v=o({isEmpty:!1,isDisabled:!1}),b=o({isEmpty:!1,isDisabled:!1}),g=o({isEmpty:!1,isDisabled:!1}),E=o({isEmpty:!1,isDisabled:!1}),y=o({isEmpty:!1,isDisabled:!1}),D=o({isEmpty:!1,isDisabled:!1}),H=o({isDisabled:!1,isEmpty:!1}),M=o({isDisabled:!1,isEmpty:!1}),R=o({isDisabled:!1,isEmpty:!1}),T=o({isDisabled:!1,isEmpty:!1}),w=o({isDisabled:!1,isEmpty:!1});o([]);const e=o({nome:"",logradouro:"",cep:"",complemento:"",numero:"",telefone:"",cidade:"",usuario_id:0});var t={};const z=async()=>{t={...e.value};try{t.cpf=t.cpf.replace(/\D/g,"")}catch{try{t.cnpj=t.cnpj.replace(/\D/g,"")}catch{}}return t.cep=t.cep.replace(/\D/g,""),t.telefone=t.telefone.replace(/\D/g,""),t},L=()=>{const u=d(v.value,e.value.nome),r=d(b.value,e.value.logradouro),f=d(g.value,e.value.cep),A=d(y.value,e.value.numero),I=d(D.value,e.value.cidade),K=!(!e.value.cpf&&!e.value.cnpj);return u&&r&&f&&A&&I&&K},C=async()=>{h(m.value,!0);const u=await z();if(!L())return h(m.value,!1);await q.store("/cliente",u).then(r=>{console.log(r),r.status?p.show("success",r.messageCode):p.show("error",r.messageCode)}).catch(r=>{p.show("error","unexpected-error")}).finally(()=>{h(m.value,!1),W(e.value)})},U=async()=>{if(e.value.cep.length<9)return;const u=e.value.cep.replace(/\D/g,"");await q.get(`https://viacep.com.br/ws/${u}/json/`).then(r=>{console.log(r),e.value.logradouro=r.logradouro,e.value.cidade=r.localidade}).catch(r=>{console.log("Erro ao buscar dados de cep")})};return V(()=>e.value.cep,()=>U()),V(c,()=>{c.value==1?delete e.value.cpf:(delete e.value.cnpj,delete e.value.inscricao_estadual,delete e.value.inscricao_municipal)}),J(()=>{Q("Enter",C),e.value.usuario_id=1}),(u,r)=>(N(),_(Y,null,{default:n(()=>[i("div",Z,[r[3]||(r[3]=i("p",null,"Selecione o tipo de pessoa?",-1)),i("div",ee,[i("label",null,x(k(S).to("normal-person")),1),j(i("input",{type:"radio",name:"register","onUpdate:modelValue":r[0]||(r[0]=f=>c.value=f),value:"0"},null,512),[[$,c.value]]),i("label",null,x(k(S).to("juridic-person")),1),j(i("input",{type:"radio",name:"register","onUpdate:modelValue":r[1]||(r[1]=f=>c.value=f),value:"1"},null,512),[[$,c.value]])])]),c.value==0?(N(),_(B,{key:0,onHelper:r[2]||(r[2]=f=>k(p).helperCreateFormOrder("register-client-helper-text")),title:"create-client",push:{label:"list-client",to:"/client/list"}},{body:n(()=>[l(a,{label:"name",required:"",reference:e.value,referenceName:"nome",controller:v.value},null,8,["reference","controller"]),l(s),l(a,{label:"phone",mask:"(##)#####-####",required:"",reference:e.value,referenceName:"telefone",controller:w.value},null,8,["reference","controller"]),l(s),l(a,{mask:"#####-###",label:"cep",required:"",reference:e.value,referenceName:"cep",controller:g.value},null,8,["reference","controller"]),l(G,null,{cep:n(()=>r[4]||(r[4]=[])),logradouro:n(()=>[l(a,{label:"logradouro",required:"",reference:e.value,referenceName:"logradouro",controller:b.value},null,8,["reference","controller"])]),numero:n(()=>[l(a,{label:"number",mask:"XXXXX",required:"",reference:e.value,referenceName:"numero",controller:y.value},null,8,["reference","controller"])]),complemento:n(()=>[l(a,{label:"complement",reference:e.value,referenceName:"complemento",controller:E.value},null,8,["reference","controller"])]),cidade:n(()=>[l(a,{label:"city",controller:D.value,reference:e.value,referenceName:"cidade",required:""},null,8,["controller","reference"])]),_:1}),l(s),l(a,{label:"cpf",mask:"###.###.###-##",reference:e.value,referenceName:"cpf",controller:H.value},null,8,["reference","controller"])]),handler:n(()=>[l(F,{onClick:C,label:"create-client",controller:m.value},null,8,["controller"])]),_:1})):X("",!0),c.value==1?(N(),_(B,{key:1,title:"create-client",push:{label:"list-client",to:"/client/list"}},{body:n(()=>[l(a,{label:"name",required:"",reference:e.value,referenceName:"nome",controller:v.value},null,8,["reference","controller"]),l(s),l(a,{label:"phone",mask:"(##)#####-####",required:"",reference:e.value,referenceName:"telefone",controller:w.value},null,8,["reference","controller"]),l(s),l(a,{mask:"#####-###",label:"cep",required:"",reference:e.value,referenceName:"cep",controller:g.value},null,8,["reference","controller"]),l(G,null,{cep:n(()=>r[5]||(r[5]=[])),logradouro:n(()=>[l(a,{label:"logradouro",required:"",reference:e.value,referenceName:"logradouro",controller:b.value},null,8,["reference","controller"])]),numero:n(()=>[l(a,{label:"number",mask:"#####",required:"",reference:e.value,referenceName:"numero",controller:y.value},null,8,["reference","controller"])]),complemento:n(()=>[l(a,{label:"complement",reference:e.value,referenceName:"complemento",controller:E.value},null,8,["reference","controller"])]),cidade:n(()=>[l(a,{label:"city",controller:D.value,reference:e.value,referenceName:"cidade",required:""},null,8,["controller","reference"])]),_:1}),l(s),l(a,{label:"cnpj",mask:"##.###.###/####-##",reference:e.value,referenceName:"cnpj",controller:M.value},null,8,["reference","controller"]),l(s),l(a,{label:"state-register",mask:"###############",reference:e.value,referenceName:"inscricao_estadual",controller:R.value},null,8,["reference","controller"]),l(s),l(a,{label:"local-register",mask:"###############",reference:e.value,referenceName:"inscricao_municipal",controller:T.value},null,8,["reference","controller"])]),handler:n(()=>[l(F,{onClick:C,label:"create-client",controller:m.value},null,8,["controller"])]),_:1})):X("",!0)]),_:1}))}});export{fe as default};
