import{d as C,u as w,r as o,p as F,o as S,i as k,w as i,J as v,f as x,b as l}from"./index-CtdWVGE4.js";import{b as $,a as n,n as q,f as p}from"./Validator-BLuEWHG9.js";import{R as u}from"./Response-Cdpp2_KF.js";import{_ as N}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-3w5KMU_p.js";import{_ as V}from"./FormLayout.vue_vue_type_script_setup_true_lang-Du2JUmel.js";import{_ as E}from"./SGSButton.vue_vue_type_script_setup_true_lang-DvxYfA5O.js";import{S as b}from"./SGSDivider-Cdrz1sw5.js";import{_}from"./SGSSelect.vue_vue_type_script_setup_true_lang-D4rAraf9.js";const U=C({__name:"CreateCityView",setup(B){const y=w().request,r=o({isLoading:!1,isDisabled:!1}),t=o({isEmpty:!1,notFound:!1,isDisabled:!0}),s=o({isEmpty:!1,notFound:!1,isDisabled:!0}),c=o({}),d=o({}),a=o({nome:"",uf:""}),h=()=>{const e=p(t.value,a.value.nome),m=p(s.value,a.value.uf);return e&&m},D=async()=>{await v.get("https://servicodados.ibge.gov.br/api/v1/localidades/estados").then(e=>{e.data?(c.value=e.data,s.value.isDisabled=!1):s.value.notFound=!0}).catch(e=>{s.value.isDisabled=!0,s.value.notFound=!0})},g=async()=>{await v.get(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${a.value.uf}/distritos`).then(e=>{e.data?(d.value=e.data,t.value.isDisabled=!1):t.value.notFound=!0}).catch(e=>{t.value.notFound=!0,t.value.isDisabled=!0})},f=async()=>{if(n(r.value,!0),!h())return n(r.value,!1);await y.store("/cidade",a.value).then(e=>{e.status?u.show("success",e.messageCode):u.show("error",e.messageCode)}).catch(e=>{u.show("error","unexpected-error")}).finally(()=>{n(r.value,!1),q(a.value)})};return F(()=>a.value.uf,g),S(()=>{D(),$("Enter",f)}),(e,m)=>(x(),k(N,null,{default:i(()=>[l(V,{title:"create-city",push:{label:"list-city",to:"/city/list"}},{body:i(()=>[l(_,{label:"uf",items:c.value,track:{field:"sigla",name:"nome"},controller:s.value,reference:a.value,referenceName:"uf",required:""},null,8,["items","controller","reference"]),l(b),l(_,{label:"city",items:d.value,track:{field:"nome",name:"nome"},controller:t.value,reference:a.value,referenceName:"nome",required:""},null,8,["items","controller","reference"]),l(b)]),handler:i(()=>[l(E,{onClick:f,label:"create-city",controller:r.value},null,8,["controller"])]),_:1})]),_:1}))}});export{U as default};
