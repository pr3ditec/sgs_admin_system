import{_ as g}from"./SGSButton.vue_vue_type_script_setup_true_lang-TC2PI5U5.js";import{S as p}from"./SGSDivider-DtGz0GqX.js";import{_}from"./SGSSelect.vue_vue_type_script_setup_true_lang-D19_k6A9.js";import{b as y,a as n,h as C,f as v}from"./Validator-BLuEWHG9.js";import{R as u}from"./Response-CeNjMucE.js";import{_ as P}from"./DefaultLayout.vue_vue_type_script_setup_true_lang-DbfjE3bo.js";import{_ as k}from"./FormLayout.vue_vue_type_script_setup_true_lang-C1zYCnRE.js";import{d as F,u as S,r as a,o as V,i as q,w as c,f as x,b as r}from"./index-DcHHFHWs.js";const K=F({__name:"AddPermissionView",setup(E){const l=S().request,m=a([]),d=a([]),s=a({permissao_id:0,usuario_id:0}),o=a({isDisabled:!1,isLoading:!1}),t=a({isDisabled:!0,notFound:!1,isEmpty:!1}),i=a({isDisabled:!0,notFound:!1,isEmpty:!1}),b=async()=>{await l.get("/usuario").then(e=>{e.status?(m.value=e.list,t.value.isDisabled=!1):t.value.notFound=!0})},D=async()=>{await l.get("/permissao").then(e=>{e.status?(d.value=e.list,i.value.isDisabled=!1):i.value.notFound=!0})},h=()=>{const e=v(t.value,s.value.usuario_id);return v(i.value,s.value.permissao_id)&&e},f=async()=>{if(n(o.value,!0),!h())return n(o.value,!1);await l.store("/usuario-permissao",s.value).then(e=>{e.status?u.show("success",e.messageCode):u.show("error",e.messageCode)}).catch(e=>{u.show("error","unexpected-error")}).finally(()=>{n(o.value,!1),C(s.value)})};return V(()=>{Promise.all([b(),D()]).catch(e=>{console.log("Erro ao buscar dados de api")}),y("Enter",f)}),(e,w)=>(x(),q(P,null,{default:c(()=>[r(k,{title:"add-permission",push:{label:"list-permission",to:"/permission/list"}},{body:c(()=>[r(_,{items:m.value,label:"users",track:{field:"id",name:"nome"},controller:t.value,reference:s.value,referenceName:"usuario_id",required:""},null,8,["items","controller","reference"]),r(p),r(_,{items:d.value,label:"permission",track:{field:"id",name:"nome"},controller:i.value,reference:s.value,referenceName:"permissao_id",required:""},null,8,["items","controller","reference"]),r(p)]),handler:c(()=>[r(g,{onClick:f,label:"create-user",controller:o.value},null,8,["controller"])]),_:1})]),_:1}))}});export{K as default};
